<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°é›è‹±æ–‡å†’éšª - è‹±èªåŠ›æ¸¬é©—ç‰ˆ</title>
    <style>
        :root {
            --scene-bg: #e8f5e9;
            --scene-accent: #81c784;
            --chick-yellow: #ffec85;
            --chick-orange: #ff9d42;
            --text-color: #333;
            --gold: #ffd700;
        }

        body.easy { --scene-bg: #e8f5e9; --scene-accent: #2e7d32; }
        body.medium { --scene-bg: #fff3e0; --scene-accent: #e65100; }
        body.hard { --scene-bg: #37474f; --scene-accent: #ff5252; --text-color: #fff; }

        * { box-sizing: border-box; transition: all 0.4s ease; }

        body {
            background-color: var(--scene-bg);
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            min-height: 100vh; margin: 0; color: var(--text-color); overflow-x: hidden; position: relative;
        }

        #bg-elements { position: absolute; width: 100%; height: 100%; z-index: -1; pointer-events: none; }
        .floating { position: absolute; animation: float 6s infinite ease-in-out; opacity: 0.2; font-size: 2rem; }
        @keyframes float { 0%, 100% { transform: translateY(0) rotate(0deg); } 50% { transform: translateY(-20px) rotate(15deg); } }

        #top-info {
            position: fixed; top: 20px; width: 90%; max-width: 500px;
            display: flex; justify-content: space-between; align-items: center;
            background: rgba(255,255,255,0.9); padding: 12px 25px; border-radius: 50px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08); z-index: 10; color: #333;
        }

        #character-container { text-align: center; margin-bottom: 20px; z-index: 5; position: relative; }
        .chick {
            width: 100px; height: 100px; background-color: var(--chick-yellow);
            border-radius: 50% 50% 45% 45%; position: relative; border: 4px solid #fff;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1); margin: 0 auto;
        }
        .eye { position: absolute; top: 40%; width: 8px; height: 8px; background: #333; border-radius: 50%; }
        .eye.left { left: 30%; }
        .eye.right { right: 30%; }
        .beak { position: absolute; top: 55%; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 8px solid transparent; border-right: 8px solid transparent; border-top: 10px solid var(--chick-orange); }
        
        #equipment-slots {
            position: absolute; width: 200px; height: 200px;
            top: 50%; left: 50%; transform: translate(-50%, -50%);
            pointer-events: none;
        }
        .eq-item { position: absolute; font-size: 24px; opacity: 0; transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); transform: scale(0); }
        .eq-item.active { opacity: 1; transform: scale(1); }
        /* 10 è£å‚™ä½ç½® */
        .eq-0 { top: 0; left: 0; } .eq-1 { top: -25px; left: 50%; transform: translateX(-50%); } 
        .eq-2 { top: 0; right: 0; } .eq-3 { left: -25px; top: 50%; transform: translateY(-50%); }
        .eq-4 { right: -25px; top: 50%; transform: translateY(-50%); } .eq-5 { bottom: 0; left: 0; }
        .eq-6 { bottom: -25px; left: 50%; transform: translateX(-50%); } .eq-7 { bottom: 0; right: 0; }
        .eq-8 { top: 20px; left: 20px; } .eq-9 { top: 20px; right: 20px; }

        .happy { animation: jump 0.5s ease; }
        @keyframes jump { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-40px); } }
        .shake { animation: shake 0.4s ease; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }

        #chick-speech { margin-top: 15px; padding: 12px 20px; background: white; border-radius: 15px; font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.05); position: relative; color: #333; max-width: 320px; line-height: 1.4; text-align: center; }

        #game-box {
            background: white; padding: 25px; border-radius: 28px; box-shadow: 0 20px 50px rgba(0,0,0,0.1);
            text-align: center; width: 95%; max-width: 500px; z-index: 5; color: #333;
        }

        .stage-badge { display: inline-block; padding: 4px 12px; border-radius: 20px; background: #eee; font-size: 12px; margin-bottom: 10px; font-weight: 800; color: var(--scene-accent); }
        .question { font-size: 17px; margin-bottom: 20px; line-height: 1.6; font-weight: 600; text-align: left; }
        .en-q { color: #555; font-style: italic; font-size: 15px; display: block; margin-top: 5px; border-left: 3px solid var(--scene-accent); padding-left: 10px; }

        .options-grid { display: flex; flex-direction: column; gap: 10px; }

        button {
            padding: 15px 20px; border: 2px solid #f0f0f0; background: #fff; border-radius: 15px;
            cursor: pointer; font-size: 18px; font-weight: bold; color: #444; transition: all 0.2s;
            display: flex; align-items: center; justify-content: center;
        }
        button:hover:not(:disabled) { border-color: var(--scene-accent); transform: scale(1.02); background: #fafafa; }
        button:active { transform: scale(0.98); }
        button.correct { background: #81c784 !important; color: white; border-color: #81c784; }
        button.wrong { background: #e57373 !important; color: white; border-color: #e57373; }

        #ceremony {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95);
            display: none; flex-direction: column; align-items: center; justify-content: center;
            color: white; z-index: 100; text-align: center;
        }
        #progress-bar { position: fixed; bottom: 0; left: 0; height: 10px; background: var(--scene-accent); width: 0%; transition: width 0.5s; }
    </style>
</head>
<body class="easy">

    <div id="bg-elements"></div>

    <div id="top-info">
        <span id="scene-name">ğŸŒ² å–®å­—æŒ‘æˆ°</span>
        <span>å¾—åˆ†: <strong id="score-val">0</strong></span>
    </div>

    <div id="character-container">
        <div id="equipment-slots">
            <div class="eq-item eq-0">ğŸ§­</div><div class="eq-item eq-1">ğŸ’</div><div class="eq-item eq-2">ğŸ¼</div>
            <div class="eq-item eq-3">ğŸ§¥</div><div class="eq-item eq-4">ğŸ›°ï¸</div>
            <div class="eq-item eq-5">â›‘ï¸</div><div class="eq-item eq-6">ğŸ¦º</div><div class="eq-item eq-7">ğŸ‘¢</div>
            <div class="eq-item eq-8">ğŸ•¸ï¸</div><div class="eq-item eq-9">ğŸ—¡ï¸</div>
        </div>
        <div class="chick" id="chick-sprite">
            <div class="eye left"></div>
            <div class="eye right"></div>
            <div class="beak"></div>
        </div>
        <div id="chick-speech">"æº–å‚™å¥½äº†å—ï¼ŸReady?"</div>
    </div>

    <div id="game-box">
        <div class="stage-badge" id="stage-info">QUIZ START</div>
        <div class="question" id="question-text">æŒ‘æˆ°é–‹å§‹ï¼é»æ“Šé¸é …è½ç™¼éŸ³ã€‚<span class="en-q">Test start! Click options to hear pronunciation.</span></div>
        <div class="options-grid" id="options-container">
            <button onclick="initGame()" style="background: var(--chick-yellow); border:none;">Let's Go! ğŸš€</button>
        </div>
    </div>

    <div id="ceremony">
        <div style="font-size: 80px;">ğŸ†</div>
        <h1 style="color: var(--gold); font-size: 2rem;">LEGENDARY SURVIVOR</h1>
        <p id="ceremony-text" style="padding: 0 40px; line-height: 1.6;"></p>
        <button onclick="location.reload()" style="background: var(--gold); border:none; padding: 15px 40px; border-radius:50px; font-weight:bold; margin-top:20px; cursor:pointer;">Play Again / å†æŒ‘æˆ°ä¸€æ¬¡</button>
    </div>

    <div id="progress-bar"></div>

    <script>
        // --- é¡Œåº« (é¸é …å…¨è‹±æ–‡) ---
        
        const easyData = [
            { q: "æ£®æ—æ˜¯ä¸€å€‹è¤‡é›œçš„ã€Œç”Ÿæ…‹ç³»çµ±ã€ã€‚", eq: "The forest is a complex 'Ecosystem'.", a: ["Economy", "Ecosystem", "Biology"], c: 1 },
            { q: "æ¤ç‰©é€éã€Œå…‰åˆä½œç”¨ã€è£½é€ èƒ½é‡ã€‚", eq: "Plants produce energy through 'Photosynthesis'.", a: ["Photosynthesis", "Photography", "Physics"], c: 0 },
            { q: "æˆ‘å€‘è¦ä¿è­·æ£®æ—çš„ã€Œç”Ÿç‰©å¤šæ¨£æ€§ã€ã€‚", eq: "We must protect the forest's 'Biodiversity'.", a: ["Diversity", "Biodiversity", "Society"], c: 1 },
            { q: "é€™è£¡æ˜¯é‡ç”Ÿå‹•ç‰©çš„å¤©ç„¶ã€Œæ£²æ¯åœ°ã€ã€‚", eq: "This is a natural 'Habitat' for wildlife.", a: ["Habit", "Habitat", "Heaven"], c: 1 },
            { q: "ç”Ÿç‰©å¿…é ˆå­¸æœƒã€Œé©æ‡‰ã€ç’°å¢ƒã€‚", eq: "Creatures must learn 'Adaptation' to survive.", a: ["Adaptation", "Adoption", "Attention"], c: 0 },
            { q: "ç…å­æ˜¯è‡ªç„¶ç•Œä¸­çš„ã€Œæ•é£Ÿè€…ã€ã€‚", eq: "Lions are 'Predators' in the wild.", a: ["Predator", "Prey", "Player"], c: 0 },
            { q: "å…”å­å¸¸æˆç‚ºè€é·¹çš„ã€Œçµç‰©ã€ã€‚", eq: "Rabbits are often 'Prey' for eagles.", a: ["Predator", "Prey", "Price"], c: 1 },
            { q: "é•·é ¸é¹¿æ˜¯ã€Œè‰é£Ÿæ€§çš„ã€å‹•ç‰©ã€‚", eq: "Giraffes are 'Herbivorous' animals.", a: ["Carnivorous", "Herbivorous", "Omnivorous"], c: 1 },
            { q: "è€è™æ˜¯å¼·å£¯çš„ã€Œè‚‰é£Ÿæ€§çš„ã€å‹•ç‰©ã€‚", eq: "Tigers are strong 'Carnivorous' animals.", a: ["Carnivorous", "Herbivorous", "Omnivorous"], c: 0 },
            { q: "äººé¡é€šå¸¸æ˜¯ã€Œé›œé£Ÿæ€§çš„ã€ã€‚", eq: "Humans are generally 'Omnivorous'.", a: ["Carnivorous", "Herbivorous", "Omnivorous"], c: 2 }
        ];

        const mediumData = [
            { q: "æ±‚ç”Ÿ 333 åŸå‰‡ï¼šæ²’ç©ºæ°£åƒ…èƒ½æ´» 3 åˆ†é˜ã€‚", eq: "333 Rule: 3 minutes without Air.", a: ["Three Minutes", "Thirty Minutes", "Three Hours"], c: 0, r: "ç¾…ç›¤ ğŸ§­", e: 0 },
            { q: "æ±‚ç”Ÿ 333 åŸå‰‡ï¼šå¤±æº«é˜²è­·ä¸è¶³åƒ…èƒ½æ´» 3 å°æ™‚ã€‚", eq: "333 Rule: 3 hours without Shelter.", a: ["Three Minutes", "Three Hours", "Three Days"], c: 1, r: "ä¿æš–æ–—ç¯· ğŸ§¥", e: 3 },
            { q: "æ±‚ç”Ÿ 333 åŸå‰‡ï¼šæ²’é£²æ°´åƒ…èƒ½æ´» 3 å¤©ã€‚", eq: "333 Rule: 3 days without Water.", a: ["Three Hours", "Three Days", "Three Weeks"], c: 1, r: "å†’éšªæ°´å£º ğŸ¼", e: 2 },
            { q: "æ±‚ç”Ÿ 333 åŸå‰‡ï¼šæ²’é£Ÿç‰©åƒ…èƒ½æ´» 3 é€±ã€‚", eq: "333 Rule: 3 weeks without Food.", a: ["Three Days", "Three Weeks", "Three Months"], c: 1, r: "è¡Œå‹•ç³§ ğŸ’", e: 1 },
            { q: "ã€ŒæŒ‡å—é‡ã€åœ¨è¿·è·¯æ™‚å¾ˆæœ‰ç”¨ã€‚", eq: "A 'Compass' is useful when lost.", a: ["Compass", "Mirror", "Hammer"], c: 0 },
            { q: "é€™æ˜¯ä¸€æ”¯ã€Œè¡›æ˜Ÿæ‰‹æ©Ÿã€ã€‚", eq: "This is a 'Satellite Phone'.", a: ["GPS", "Satellite Phone", "LAN"], c: 1, r: "é€šè¨Šå™¨ ğŸ›°ï¸", e: 4 },
            { q: "ä½ éœ€è¦ã€Œé˜²æ°´çš„ã€å¤–å¥—ã€‚", eq: "You need a 'Waterproof' jacket.", a: ["Waterproof", "Waterslide", "Waterfall"], c: 0 },
            { q: "ã€Œé€šè¨Šã€åœ¨æ±‚ç”Ÿä¸­å¾ˆé—œéµã€‚", eq: "Communication is key in survival.", a: ["Communication", "Energy", "Digital"], c: 0 },
            { q: "ç¾…ç›¤ä¸Šçš„ 'W' ä»£è¡¨ã€Œè¥¿æ–¹ã€ã€‚", eq: "'W' on a compass stands for 'West'.", a: ["East", "West", "North"], c: 1 },
            { q: "å¸¶ä¸€äº›ã€Œé«˜èƒ½é‡ã€çš„é›¶é£Ÿã€‚", eq: "Bring some 'High-energy' snacks.", a: ["High-energy", "High-water", "Heavy"], c: 0 }
        ];

        const hardData = [
            { q: "å¦‚æœä½ é‡åˆ°é»‘ç†Šï¼Œè«‹æ…¢æ…¢å¾Œé€€ã€‚", eq: "If you encounter a bear, back away slowly.", a: ["Run away", "Back away slowly", "Play dead"], c: 1, r: "é˜²è­·é ­ç›” â›‘ï¸", e: 5 },
            { q: "åœ¨åŠ‡çƒˆäº‚æµä¸­ï¼Œè«‹ç©¿ä¸Šæ•‘ç”Ÿè¡£ã€‚", eq: "In severe turbulence, wear a life jacket.", a: ["Wear life jacket", "Jump", "Stand up"], c: 0, r: "æ•‘ç”Ÿè¡£ ğŸ¦º", e: 6 },
            { q: "åœŸçŸ³æµç™¼ç”Ÿæ™‚ï¼Œå¾€å…©å´é«˜è™•é€ƒã€‚", eq: "When a landslide occurs, move sideways.", a: ["Move sideways", "Run down", "Stay still"], c: 0, r: "ç™»å±±é´ ğŸ‘¢", e: 7 },
            { q: "è‹¥è¢«èœœèœ‚è¿½ï¼Œèº²é€²å°é–‰çš„é®è”½è™•ã€‚", eq: "If chased by bees, run to a shelter.", a: ["Jump in water", "Run to shelter", "Swat"], c: 1, r: "é˜²èŸ²ç¶² ğŸ•¸ï¸", e: 8 },
            { q: "è¢«è›‡å’¬å‚·å¾Œï¼Œä¿æŒå‚·å£ä½æ–¼å¿ƒè‡Ÿã€‚", eq: "Keep the wound below the heart after a snake bite.", a: ["Suck venom", "Keep below heart", "Run"], c: 1 },
            { q: "æ‰“é›·æ™‚ï¼Œçµ•å°ä¸è¦èº²åœ¨å¤§æ¨¹ä¸‹ã€‚", eq: "Never hide under a tree during a thunderstorm.", a: ["Low ground", "Under a tree", "Inside car"], c: 1 },
            { q: "å¦‚æœä½ åœ¨æ£®æ—è¿·è·¯ï¼Œç•™åœ¨åŸåœ°å¾…æ´ã€‚", eq: "If lost in the forest, stay where you are.", a: ["Keep walking", "Stay where you are", "Shout"], c: 1 },
            { q: "é‡æ£®æ—ç«ç½ï¼Œå¾€é€†é¢¨æ–¹å‘é€ƒç”Ÿã€‚", eq: "Run upwind to escape a forest fire.", a: ["Downwind", "Upwind", "Up hill"], c: 1 },
            { q: "æºªæ°´è®Šæ¿ä»£è¡¨ä¸Šæ¸¸å¯èƒ½æœ‰å±±æ´ªã€‚", eq: "Muddy water means a flash flood is coming.", a: ["Swimming", "Hiking", "Flash flood"], c: 2 },
            { q: "æ­å–œï¼é ˜å–ä½ çš„è‹±é›„åŠï¼", eq: "Congrats! Claim your hero sword!", a: ["Claim", "Reject", "Maybe"], c: 0, r: "è‹±é›„åŠ ğŸ—¡ï¸", e: 9 }
        ];

        const funnyLines = [
            "å“å‘€ï¼é€™ç­”æ¡ˆè®“å°é›åš‡åˆ°æ‰æ¯›äº†ï¼ / Oops! Chick lost its feathers!",
            "é€™å€‹é¸æ“‡æ¯”æ²’é›»çš„ GPS é‚„è¿·èŒ«ã€‚ / More lost than a dead GPS.",
            "å°é›èªªï¼šé€™ä¸æ˜¯æ­£ç¢ºçš„æ±‚ç”Ÿä¹‹é“ï¼ / Not the right way to survive!",
            "ä½ ç¢ºå®šå—ï¼Ÿå°é›é–‹å§‹æµæ±—äº†... / Are you sure? Chick is sweating...",
            "ç³Ÿç³•ï¼é»‘ç†Šæ­£åœ¨æ—é‚Šå·ç¬‘å–”ã€‚ / Oh no! The bear is laughing at you."
        ];

        let currentStage = "easy"; 
        let currentIdx = 0;
        let score = 0;
        let solvedCount = 0;
        const totalQuestions = 30;

        function speak(text, callback) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';
            utterance.rate = 0.95;
            if (callback) utterance.onend = callback;
            window.speechSynthesis.speak(utterance);
        }

        function initGame() {
            score = 0; currentIdx = 0; solvedCount = 0; currentStage = "easy";
            speak("Let's go! Time to be a hero!", () => loadQuestion());
        }

        function loadQuestion() {
            let data;
            if(currentStage === "easy") {
                data = easyData[currentIdx];
                document.body.className = "easy";
                document.getElementById('scene-name').innerText = "ğŸŒ² Easy: Vocabulary";
                document.getElementById('stage-info').innerText = `LEVEL 1 - ${currentIdx + 1}/10`;
            } else if(currentStage === "medium") {
                data = mediumData[currentIdx];
                document.body.className = "medium";
                document.getElementById('scene-name').innerText = "ğŸ’ Medium: Gear Check";
                document.getElementById('stage-info').innerText = `LEVEL 2 - ${currentIdx + 1}/10`;
            } else {
                data = hardData[currentIdx];
                document.body.className = "hard";
                document.getElementById('scene-name').innerText = "âš ï¸ Hard: Survival";
                document.getElementById('stage-info').innerText = `LEVEL 3 - ${currentIdx + 1}/10`;
            }

            document.getElementById('question-text').innerHTML = `${data.q}<span class="en-q">${data.eq}</span>`;
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            
            data.a.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.innerText = opt;
                btn.onclick = () => {
                    speak(opt); // é»æ“Šæ™‚å”¸å‡ºå–®å­—
                    checkAnswer(i, btn);
                };
                container.appendChild(btn);
            });
            document.getElementById('progress-bar').style.width = (solvedCount/totalQuestions * 100) + '%';
        }

        function checkAnswer(idx, btn) {
            let data = (currentStage === "easy") ? easyData[currentIdx] : 
                       (currentStage === "medium") ? mediumData[currentIdx] : hardData[currentIdx];
            
            const buttons = document.querySelectorAll('#options-container button');
            buttons.forEach(b => b.disabled = true);

            const isCorrect = idx === data.c;

            setTimeout(() => {
                if(isCorrect) {
                    btn.classList.add('correct');
                    let points = (currentStage === "easy") ? 10 : (currentStage === "medium" ? 20 : 30);
                    score += points;
                    document.getElementById('chick-speech').innerText = "Excellent! You got it!";
                    document.getElementById('chick-sprite').classList.add('happy');
                    speak("Excellent!");
                    
                    if(data.r) {
                        setTimeout(() => {
                            const eqItem = document.querySelector(`.eq-${data.e}`);
                            if(eqItem) eqItem.classList.add('active');
                            document.getElementById('chick-speech').innerText = `Item unlocked: ${data.r}`;
                        }, 500);
                    }
                    setTimeout(() => document.getElementById('chick-sprite').classList.remove('happy'), 500);
                } else {
                    btn.classList.add('wrong');
                    buttons[data.c].classList.add('correct');
                    const humor = funnyLines[Math.floor(Math.random()*funnyLines.length)];
                    document.getElementById('chick-speech').innerText = humor;
                    document.getElementById('chick-sprite').classList.add('shake');
                    speak("Oops! Try again next time.");
                    setTimeout(() => document.getElementById('chick-sprite').classList.remove('shake'), 400);
                }

                document.getElementById('score-val').innerText = score;
                solvedCount++;
                currentIdx++;

                setTimeout(() => {
                    if(currentIdx >= 10) {
                        if(currentStage === "easy") {
                            speak("Amazing hero! Entering Medium Stage!");
                            currentStage = "medium"; currentIdx = 0; loadQuestion();
                        } else if(currentStage === "medium") {
                            speak("Great job! Entering Hard Stage!");
                            currentStage = "hard"; currentIdx = 0; loadQuestion();
                        } else {
                            finishGame();
                        }
                    } else {
                        loadQuestion();
                    }
                }, 2500);
            }, 600); // ç¨å¾®å»¶é²ä»¥ç¢ºä¿ç©å®¶è½å®Œé»æ“Šçš„å–®å­—ç™¼éŸ³
        }

        function finishGame() {
            document.getElementById('progress-bar').style.width = '100%';
            document.getElementById('ceremony').style.display = 'flex';
            document.getElementById('ceremony-text').innerText = `A legend is born! You passed 30 challenges.\nYou mastered survival skills and advanced English patterns.\nFinal Score: ${score}`;
            speak("Congratulations! You are a bilingual survival master!");
        }
    </script>
</body>
</html>
